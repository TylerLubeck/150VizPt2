<!DOCTYPE html>
<html>
<head>
<style type="text/css">
canvas{
   padding: 0 27% 2% 23%;
}
#intro{
    line-height: 2;
    text-align: left;
}
p,h2{
    font-family: "Arial";
    line-height: 0.3;
    padding: 0 25% 0 25%;
    text-align: center;
}

h2{
    padding-top: 0%;
}

p{
    font-size:0.9em;
}

button{
    width: 80px;
    height: 20px;
}

#buttons{
   margin-left:44%;

}

footer{
   font-size:10px;
}

img{
    margin-left:42%;
    text-align: center;
}

</style>

</head>
<body>
<h2 id = "title"> Adult Demographics </h2>
<p id = "intro">  </p>
<p id = "p1" >  </p>
<p id = "p2" >  </p>
<div id = "p3" style="padding-left:25%;padding-right:25%;font-family:'Arial'"> </div>
<canvas class = "canvas" id = "canvas1" onclick = "ourClick()"></canvas>
<div id = "buttons">
   <button id = "pre" onclick = "decrease()"> Previous </button>
   <button id = "next" onclick = "increase()"> Next </button>
</div>
<footer>
   <p> comp 150-07(VIZ), Lab 2: Story telling </p>
</footer>
<!--
<script src = "http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src = "http://processingjs.org/js/processing.min.js"></script>
<script type = "text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
-->

<script src = "jquery.min.js"></script>
<script src = "processing.min.js"></script>
<script type = "text/javascript" src="d3.v3.min.js"></script>

<script>

var result;
var intColor = 0;
var mode = 1;
var susiClick = false;
var data;
var adults = [];

// This is for testing
var edu = {};

function Adult(data) {
	this.Age 			= data.Age,
	this.Workclass 		= data.Workclass,
	this.Fnlwgt 		= data.Fnlwgt,
	this.Education 		= data.Education,
	this.EducationNum 	= data.EducationNum,
	this.MaritalStatus 	= data.MaritalStatus,
	this.Occupation 	= data.Occupation,
	this.Relationship 	= data.Relationship,
	this.Race 			= data.Race,
	this.Sex 			= data.Sex,
	this.CapitalGain 	= data.CapitalGain,
	this.CapitalLoss 	= data.CapitalLoss,
	this.HoursPerWeek 	= data.HoursPerWeek,
	this.Country 		= data.Country,
	this.Income 		= data.Income
};

var __do_once = true;
function createAdultArray() {
	if (__do_once) {
    for (var i=0; i< data.length; i++) {
	  	var adult = new Adult(data[i]);
	  	adults.push(adult);
	  }
    __do_once = false;
  }
}


d3.csv("data/adult.data", function(d){
	return {
			Age: 			+d.age,
			Workclass: 		d.workclass,
			Fnlwgt: 		+d.fnlwgt,
			Education: 		d.education,
			EducationNum: 	+d.educationNum,
			MaritalStatus: 	d.maritalStatus,
			Occupation: 	d.occupation,
			Relationship: 	d.relationship,
			Race: 			d.race,
			Sex: 			d.sex,
			CapitalGain: 	+d.capitalGain,
			CapitalLoss: 	+d.capitalLoss,
			HoursPerWeek: 	+d.hoursPerWeek,
			Country: 		d.country,
			Income:         d.income, 
		};
	}, function(err, d) {
		if (err) return console.log('Oops! csv died.');
		data = d;
		run(data);
});

function run(result) {
	var canvas = document.getElementById("canvas1");
	var processingInstance = new Processing(canvas, sketchProc); 
}

Number.prototype.mod = function(n) { return ((this%n)+n)%n; };

function ourClick() {
	if (mode == 1) {
		susiClick = true;
	}
}

function increase(){
  mode = (mode + 1).mod(3);
	//mode += 1;
  document.getElementById("p3").innerHTML = "";
	run(result);
}

function decrease(){
	mode = (mode - 1).mod(3);
  //mode -= 1;
  document.getElementById("p3").innerHTML = "";
	run(result);
}

var margin = 30, iWidth = 600, iHeight = 400;
function sketchProc(p) {	
   
   createAdultArray();
   p.setup = function(){ 

	   p.size(iWidth + 2 * margin, iHeight + 2 * margin, p.P2D);
	   $("#canvas1").css("width","" + p.width);
	   $("#canvas1").css("height","" + p.height);
	   p.smooth();   	 
	   p.rectMode(p.CORNER);
	   p.ellipseMode(p.RADIUS);
   }
   
   p.draw = function() {
   p.background(p.color(250));
 
   switch (mode) {

   case 0: // Justin
       //step0(p);
       break; 
   case 1: // Susi
       step1(p, susiClick);
       susiClick = false;
       break;
   case 2: // Karl
       step2(p);
       break;
   };
  };
  
   /*function step0(){ // Justin
	   // $()s are jQuery code. 
	   $("#title").css("padding-top","10%");
	   $("#pre").prop("disabled",true);
	   $("#next").prop("disabled",false);
	   
	   $("#intro").css("padding-left", "40%");
	   $("#intro").show();
       $("#poster").show();
       
	   $("#intro").text("Step 0");
       $("#canvas1").hide();
       $("#p1").hide();
       $("#p2").hide();
       $("#p3").hide();
   }*/
   
   /*function step1(){ // Susi
       $("#poster").hide();
       $("#canvas1").show();
	   $("p").show();
	   
	   $("#intro").hide();	   
	   
	   $("#pre").prop("disabled",false);
	   $("#next").prop("disabled",false);
	     
	   // The example to write processing.js code in Javasript
	   p.textAlign(p.CENTER);
	   // The example to use teh "result dataset"
	   p.text(result[0].Title, p.width / 2.0, p.height / 3.0);
	   p.text("I'm dying!!!!!!!", p.width / 2.0, p.height / 3.0 - 20);
	   // I'm calling local JavaScript function here
	   cat(p.width / 2.0 + Math.random() * 50, p.height / 2.0 + Math.random() * 10, 30, Math.random());
	   $("#p1").text("p1");
	   $("#p2").text("p2");
	   $("#p3").text("p3");		   
   }*/
  
   /* 
   function step2(){ // Karl
	   $("#pre").prop("disabled",false);
	   $("#next").prop("disabled",true);
	   
	   cat(p.width / 2.0, p.height / 2.0, 50, Math.random() * 10);
	   
	   $("#p1").text("p1");
	   $("#p2").text("p2");
	   $("#p3").hide();   
   }*/
   
   function cat(x, y, size, random){   
	   var headSize = size * 2 / 3, earSize = size * 0.4, eyeSize = (size * 0.005 - 1 > 0)? (size * 0.005) : 1;
	   p.noStroke();
	   p.triangle(x - earSize * 2, y - size * 0.15, x - earSize , y - size * 0.45, x - 1.5 * earSize, y - size * 0.15 - p.sqrt(3) * earSize);
       p.triangle(x + earSize * 2, y - size * 0.15, x + earSize , y - size * 0.45, x + 1.5 * earSize, y - size * 0.15 - p.sqrt(3) * earSize);
	   p.ellipse(x, y + 1 / 4 * size, headSize / ( 3 / 4 ) , headSize); // head
	   p.stroke(p.color(0));
	   p.strokeWeight(size * 0.2);
	   p.fill(p.color());
	   if(!random){
		   random = 0;
	   }
	   p.bezier(x - headSize , y + 1 / 2 * size,  
			   x - 1 * headSize,  y + 2 /2 * size,
			   x - 2 * headSize,  y + 1 /2 * size + random,
			   x - 3 * headSize,  y + 2 /2* size + random); // head
    }
   }


 </script>
 
 <script src="step0.js"></script>
 <script src="step1.js"></script>
 <script src="step2.js"></script>

</body>
</html>
